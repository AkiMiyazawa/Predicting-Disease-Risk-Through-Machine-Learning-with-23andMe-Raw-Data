import sys
import os
import argparse
import pandas as pd
import numpy as np
import joblib
from xgboost import XGBClassifier

# Print iterations progress
def printProgressBar (iteration, total, prefix = '', suffix = '', decimals = 1, length = 100, fill = 'â–ˆ', printEnd = "\r"):
    """
    Call in a loop to create terminal progress bar
    @params:
        iteration   - Required  : current iteration (Int)
        total       - Required  : total iterations (Int)
        prefix      - Optional  : prefix string (Str)
        suffix      - Optional  : suffix string (Str)
        decimals    - Optional  : positive number of decimals in percent complete (Int)
        length      - Optional  : character length of bar (Int)
        fill        - Optional  : bar fill character (Str)
        printEnd    - Optional  : end character (e.g. "\r", "\r\n") (Str)
    """
    percent = ("{0:." + str(decimals) + "f}").format(100 * (iteration / float(total)))
    filledLength = int(length * iteration // total)
    bar = fill * filledLength + '-' * (length - filledLength)
    print(f'\r{prefix} |{bar}| {percent}% {suffix}', end = printEnd)
    # Print New Line on Complete
    if iteration == total: 
        print()


if __name__ == "__main__":
	parser = argparse.ArgumentParser(description='basic_assembly.py takes in data for homework assignment 3 consisting '
	                                             'of a set of reads and aligns the reads to the reference genome.')
	parser.add_argument('-f', required=False, dest='data_fp',
	                    help='File containing your 23andme raw data')

	parser.add_argument('-p', required=False, dest='processed_fp',
	                    help='File containing your previously processed 23andme data')

	age = int(input("Enter your age: "))
	args = parser.parse_args()
	data_fn = args.data_fp
	if data_fn:
		user_data = pd.read_csv(data_fn, sep='\t', dtype={'rsid':'str', 'chromosome':'object', 'position':'int', 'genotype':'str'}, 
								comment='#', names = ['rsid', 'chromosome', 'position', 'genotype'])
		if user_data is None:
		    sys.exit(1)

		print("Processing your data...")

		l = user_data.shape[0]
		mapping_user = {}

		# Initial call to print 0% progress
		printProgressBar(0, l, prefix = 'Progress:', suffix = 'Complete', length = 50)
		for i, row in user_data.iterrows():
			alleles = list(row['genotype'])
			if row['rsid'] not in mapping_user:
				mapping_user[row['rsid']] = alleles
			else:
				mapping_user[row['rsid']]+=alleles

			printProgressBar(i + 1, l, prefix = 'Progress:', suffix = 'Complete', length = 50)

		np.save('processed_data.npy', mapping_user)
		print("Your data is processed.")
	elif args.processed_fp:
		# Load
		print("Loading your processed data...")
		mapping_user = np.load('processed_data.npy',allow_pickle='TRUE').item()

	else:
		print("Your need to specifc your data.")
		exit()

	"""
	Alzheimer
	"""
	print("Predicting your risk factor for Alzheimer's disease...")
	#mapping of rsid to risk allele
	# mapping_alzheimer = {'rs8077028': ['T'], 'rs2244526': ['T'], 'rs17022021': ['T'], 'rs1034435': ['A'], 'rs4760243': ['A'], 'rs7260181': ['T'], 'rs12716755': ['A'], 'rs3820443': ['T'], 'rs846858': ['A'], 'rs5771225': ['T'], 'rs7313581': ['T'], 'rs2699450': ['A'], 'rs6945197': ['T'], 'rs184992198': ['T'], 'rs115972394': ['A'], 'rs73215707': ['T'], 'rs79926713': ['T'], 'rs73732514': ['A'], 'rs62177277': ['T'], 'rs73681522': ['A'], 'rs2234017': ['C'], 'rs147597631': ['T'], 'rs145848414': ['A'], 'rs147985478': ['A'], 'rs116050881': ['T'], 'rs116530595': ['T'], 'rs147582129': ['T'], 'rs72998574': ['T'], 'rs144471255': ['A'], 'rs144216026': ['A'], 'rs137869973': ['T'], 'rs72840936': ['C'], 'rs148587130': ['T'], 'rs185126971': ['A'], 'rs73239797': ['A'], 'rs113884973': ['C'], 'rs182972826': ['T'], 'rs112920270': ['A'], 'rs141104697': ['A'], 'rs144464515': ['C'], 'rs191707442': ['T'], 'rs150269952': ['T'], 'rs144998240': ['A'], 'rs138543081': ['T'], 'rs192013290': ['T'], 'rs144077517': ['A'], 'rs142835438': ['A'], 'rs184695264': ['T'], 'rs921390': ['T'], 'rs150291119': ['A'], 'rs11967676': ['G'], 'rs4955783': ['G'], 'rs181850653': ['T'], 'rs80011616': ['A'], 'rs114090132': ['T'], 'rs117556552': ['T'], 'rs117908734': ['T'], 'rs8039237': ['C'], 'rs186911969': ['T'], 'rs137929838': ['T'], 'rs7576531': ['T'], 'rs140442947': ['C'], 'rs116105213': ['C'], 'rs17488073': ['G'], 'rs182645021': ['C'], 'rs10455152': ['C'], 'rs79846291': ['T'], 'rs149454736': ['T'], 'rs139934868': ['G'], 'rs78927322': ['G'], 'rs146446983': ['C'], 'rs62125664': ['A'], 'rs75627662': ['T'], 'rs147906088': ['T'], 'rs56214552': ['G'], 'rs6479525': ['A'], 'rs62187521': ['T'], 'rs72639058': ['T'], 'rs117905930': ['T'], 'rs186542490': ['A'], 'rs186076999': ['T'], 'rs141521929': ['T'], 'rs73865608': ['A'], 'rs184614511': ['T'], 'rs193129245': ['A'], 'rs150061627': ['T'], 'rs190457471': ['A'], 'rs141387448': ['T'], 'rs117760708': ['T'], 'rs187423924': ['A'], 'rs181634374': ['T'], 'rs145228677': ['C'], 'rs188699384': ['A'], 'rs148003968': ['A'], 'rs185867524': ['A'], 'rs117756856': ['A'], 'rs184457411': ['A'], 'rs180751169': ['T'], 'rs188392327': ['A'], 'rs192232892': ['T'], 'rs149839710': ['A'], 'rs150631144': ['T'], 'rs144573434': ['T'], 'rs181228315': ['A'], 'rs147285445': ['T'], 'rs187295598': ['T'], 'rs141976661': ['A'], 'rs77544685': ['T'], 'rs185170954': ['A'], 'rs75635567': ['T'], 'rs181696879': ['A'], 'rs146322114': ['A'], 'rs12661302': ['C'], 'rs186588455': ['A'], 'rs115443594': ['T'], 'rs183291664': ['T'], 'rs145840463': ['A'], 'rs181299481': ['A'], 'rs10060040': ['A'], 'rs62179067': ['T'], 'rs56249755': ['A'], 'rs115317194': ['T'], 'rs75770912': ['A'], 'rs7698880': ['C'], 'rs76816469': ['T'], 'rs61233297': ['A'], 'rs853656': ['T'], 'rs181990369': ['A'], 'rs145282773': ['T'], 'rs147150305': ['A'], 'rs186891871': ['C'], 'rs142660142': ['T'], 'rs139638356': ['T'], 'rs144167489': ['T'], 'rs115798104': ['A'], 'rs146997164': ['C'], 'rs138449900': ['C'], 'rs141846544': ['T'], 'rs117022236': ['A'], 'rs140587050': ['C'], 'rs114179644': ['T'], 'rs142076474': ['A'], 'rs10075047': ['A'], 'rs191404864': ['A'], 'rs112404845': ['A'], 'rs183256737': ['A'], 'rs79930850': ['A'], 'rs143261188': ['C'], 'rs115078773': ['A'], 'rs139195876': ['A'], 'rs16961023': ['C'], 'rs72842919': ['A'], 'rs9832461': ['A'], 'rs1448284': ['T'], 'rs11055612': ['C'], 'rs7155434': ['A'], 'rs2456930': ['G'], 'rs17636071': ['G'], 'rs2270875': ['G'], 'rs10078434': ['T'], 'rs283812': ['C'], 'rs62256378': ['A'], 'rs28399637': ['A'], 'rs11218343': ['C'], 'rs11771145': ['A'], 'rs1476679': ['C'], 'rs28834970': ['C'], 'rs35349669': ['T'], 'rs6656401': ['A'], 'rs6733839': ['T'], 'rs7274581': ['C'], 'rs9331896': ['C'], 'rs983392': ['G'], 'rs114360492': ['T'], 'rs184384746': ['T'], 'rs187370608': ['A'], 'rs76726049': ['C'], 'rs41289512': ['G'], 'rs76320948': ['T'], 'rs6014724': ['G'], 'rs113260531': ['A'], 'rs117618017': ['T'], 'rs111278892': ['G'], 'rs2093760': ['A'], 'rs10933431': ['G'], 'rs4575098': ['A'], 'rs6448453': ['A'], 'rs59735493': ['A'], 'rs1859788': ['A'], 'rs867611': ['G'], 'rs3865444': ['A'], 'rs442495': ['C'], 'rs12590654': ['A'], 'rs9381563': ['C'], 'rs11257238': ['C'], 'rs2081545': ['A'], 'rs4236673': ['A'], 'rs4663105': ['C'], 'rs2632516': ['C'], 'rs28394864': ['A'], 'rs7810606': ['T'], 'rs7412': ['T'], 'rs138607350': ['G'], 'rs79701229': ['A'], 'rs10407439': ['A'], 'rs2965169': ['C'], 'rs116949436': ['A'], 'rs55923289': ['C'], 'rs28469095': ['C'], 'rs111371860': ['T'], 'rs2967668': ['G'], 'rs76692773': ['T'], 'rs11672748': ['G'], 'rs595290': ['C'], 'rs346757': ['C'], 'rs34874378': ['A'], 'rs183427010': ['A'], 'rs111740474': ['A'], 'rs1160984': ['T'], 'rs11665676': ['T'], 'rs561654715': ['A'], 'rs55840414': ['A'], 'rs112481437': ['A'], 'rs203709': ['A'], 'rs11881756': ['C'], 'rs76856627': ['G'], 'rs60239918': ['T'], 'rs41290100': ['T'], 'rs846876': ['C'], 'rs147188206': ['C'], 'rs2965164': ['T'], 'rs41290108': ['C'], 'rs547509922': ['T'], 'rs62118504': ['G'], 'rs35194383': ['T'], 'rs80257887': ['A'], 'rs75161053': ['A'], 'rs142412517': ['T'], 'rs12461144': ['T'], 'rs142092405': ['G'], 'rs150820726': ['T'], 'rs183321458': ['A'], 'rs539159088': ['C'], 'rs576651896': ['G'], 'rs186110295': ['T'], 'rs78986976': ['A'], 'rs204907': ['G'], 'rs141864196': ['A'], 'rs114036675': ['A'], 'rs3752241': ['G'], 'rs11083743': ['C'], 'rs34181358': ['A'], 'rs204480': ['T'], 'rs10421247': ['C'], 'rs419010': ['C'], 'rs9653111': ['T'], 'rs769452': ['C'], 'rs143332484': ['T'], 'rs4727449': ['T'], 'rs123187': ['A'], 'rs10792832': ['A'], 'rs10948363': ['G'], 'rs1081105': ['C'], 'rs157580': ['G'], 'rs6859': ['A'], 'rs9271192': ['C'], 'rs6931277': ['T'], 'rs9469112': ['T']}
	
	mapping_alzheimer = {'rs7313581': ['T'], 'rs79926713': ['T'], 'rs73239797': ['A'], 'rs79846291': ['T'], 'rs72842919': ['A'], 'rs11055612': ['C'], 'rs7155434': ['A'], 'rs2456930': ['G'], 'rs62256378': ['A'], 'rs11218343': ['C'], 'rs11771145': ['A'], 'rs1476679': ['C'], 'rs28834970': ['C'], 'rs35349669': ['T'], 'rs6656401': ['A'], 'rs6733839': ['T'], 'rs7274581': ['C'], 'rs9331896': ['C'], 'rs983392': ['G'], 'rs3865444': ['A'], 'rs4663105': ['C'], 'rs7810606': ['T'], 'rs7412': ['T'], 'rs138607350': ['G'], 'rs2965169': ['C'], 'rs1160984': ['T'], 'rs76856627': ['G'], 'rs2965164': ['T'], 'rs62118504': ['G'], 'rs80257887': ['A'], 'rs141864196': ['A'], 'rs10421247': ['C'], 'rs143332484': ['T'], 'rs123187': ['A'], 'rs10792832': ['A'], 'rs10948363': ['G'], 'rs157580': ['G'], 'rs6859': ['A'], 'rs9271192': ['C'], 'rs6931277': ['T']}

	alzheimer_data = []
	for k,v in mapping_alzheimer.items():
		if k in mapping_user:
			is_found = False
			for a in v:
				if a in mapping_user[k]:
					alzheimer_data.append(1)
					is_found = True
					break
			if not is_found:
				alzheimer_data.append(0)
		# else:
		# 	alzheimer_data.append(np.random.choice([0,1],p=[0.7,0.3]))

	alzheimer_data = [alzheimer_data]
	alzheimer_test = pd.DataFrame(alzheimer_data)

	# Load the model from the file
	if age>=60:
		alzheimer_model = joblib.load('23andme/alzheimer-model-60-above.pkl') 
	elif age>40:
		alzheimer_model = joblib.load('23andme/alzheimer-model-60-below.pkl') 
	else:
		alzheimer_pred = [0]

	# Use the loaded model to make predictions
	if age>40:
		alzheimer_pred = alzheimer_model.predict(alzheimer_test)



	"""
	Coronary heart disease
	"""
	print("Predicting your risk factor for Coronary heart disease...")
	#mapping of rsid to risk allele
	# mapping_heart = {'rs9295128': ['T'], 'rs10455872': ['G'], 'rs186696265': ['T'], 'rs7412': ['T'], 'rs57578064': ['A'], 'rs189889864': ['A'], 'rs328': ['G'], 'rs6511720': ['T'], 'rs7528419': ['G'], 'rs76863441': ['A'], 'rs11057830': ['A'], 'rs12740374': ['T'], 'rs190543502': ['C'], 'rs147233090': ['T'], 'rs11638352': ['C'], 'rs2733201': ['T'], 'rs144972973': ['G'], 'rs62471956': ['G'], 'rs188845491': ['C'], 'rs147642358': ['G'], 'rs140607780': ['G'], 'rs140104968': ['C'], 'rs117038461': ['C'], 'rs61361928': ['T'], 'rs113681054': ['T'], 'rs11556924': ['T'], 'rs11591147': ['T'], 'rs28601761': ['C'], 'rs4932373': ['A'], 'rs72675530': ['A'], 'rs17114046': ['A'], 'rs147055617': ['A'], 'rs2128739': ['A'], 'rs4766578': ['A'], 'rs11637783': ['T'], 'rs17465982': ['A'], 'rs6919211': ['C'], 'rs1966248': ['A'], 'rs965652': ['A'], 'rs72934535': ['T'], 'rs28451064': ['A', 'G'], 'rs149487184': ['T'], 'rs157595': ['A'], 'rs11673093': ['A'], 'rs2738447': ['A'], 'rs318719': ['T'], 'rs1629862': ['A'], 'rs6060235': ['A'], 'rs73225842': ['T'], 'rs12019546': ['A'], 'rs10456100': ['T'], 'rs7766436': ['T'], 'rs1034246': ['T'], 'rs6905288': ['A'], 'rs2140480': ['T'], 'rs61741262': ['T'], 'rs112941127': ['A'], 'rs10734649': ['T'], 'rs6740731': ['A'], 'rs7604735': ['T'], 'rs72862334': ['A'], 'rs685031': ['A'], 'rs4762479': ['T'], 'rs12753816': ['T'], 'rs223290': ['T'], 'rs7342694': ['T'], 'rs11601507': ['A'], 'rs17263917': ['A'], 'rs4678145': ['C'], 'rs11170820': ['C'], 'rs112009435': ['A'], 'rs113230003': ['A'], 'rs11670056': ['T'], 'rs10841443': ['C'], 'rs7011846': ['A'], 'rs15285': ['T'], 'rs10106652': ['A'], 'rs701145': ['T'], 'rs10857147': ['A'], 'rs964184': ['C'], 'rs12414777': ['T'], 'rs655720': ['T'], 'rs7678555': ['A'], 'rs57481061': ['C'], 'rs16986953': ['A'], 'rs12930452': ['A'], 'rs12133641': ['A'], 'rs8003602': ['T'], 'rs10131519': ['T'], 'rs7214663': ['A'], 'rs191896574': ['T'], 'rs7502499': ['A'], 'rs7500448': ['A'], 'rs62068034': ['A'], 'rs7209460': ['T'], 'rs73045269': ['T'], 'rs4803455': ['A'], 'rs4894803': ['A'], 'rs1077534': ['A'], 'rs148880716': ['A'], 'rs190569784': ['A'], 'rs61776719': ['A'], 'rs7795996': ['A'], 'rs12500824': ['A'], 'rs11099493': ['A'], 'rs1591805': ['A'], 'rs11840502': ['A'], 'rs604723': ['T'], 'rs4237540': ['A'], 'rs8053891': ['A'], 'rs12999907': ['A'], 'rs4845570': ['T'], 'rs9513112': ['A'], 'rs117709627': ['T'], 'rs12495221': ['T'], 'rs73082363': ['T'], 'rs116843064': ['A'], 'rs59372292': ['T'], 'rs9469890': ['T'], 'rs113244441': ['A'], 'rs17680741': ['T'], 'rs11698996': ['C'], 'rs17228058': ['A'], 'rs246600': ['T'], 'rs10221742': ['A'], 'rs9337951': ['A'], 'rs3732837': ['A'], 'rs1169288': ['A'], 'rs6740322': ['A'], 'rs4299376': ['T'], 'rs1250259': ['A'], 'rs495828': ['T'], 'rs11057840': ['A'], 'rs10128951': ['A'], 'rs3918226': ['T'], 'rs2880099': ['A'], 'rs13131930': ['T'], 'rs2166529': ['T'], 'rs6810798': ['A'], 'rs17612693': ['A'], 'rs11617955': ['A'], 'rs4773141': ['C'], 'rs9515203': ['T'], 'rs2107595': ['A'], 'rs1412444': ['T'], 'rs10793514': ['T'], 'rs2457480': ['A'], 'rs13118820': ['A'], 'rs7692387': ['A'], 'rs145186794': ['A'], 'rs7696431': ['T'], 'rs4389656': ['A'], 'rs1508798': ['T'], 'rs459193': ['A'], 'rs832540': ['A'], 'rs9283706': ['C'], 'rs10056811': ['A'], 'rs113075218': ['A'], 'rs2081914': ['C'], 'rs273909': ['A'], 'rs9501744': ['T'], 'rs742115': ['T'], 'rs9349379': ['A'], 'rs2876643': ['A'], 'rs9379774': ['A'], 'rs2814993': ['A'], 'rs6930083': ['A'], 'rs10947789': ['T'], 'rs1214752': ['T'], 'rs3895874': ['A'], 'rs16948048': ['A'], 'rs8080784': ['T'], 'rs2286526': ['T'], 'rs1867624': ['T'], 'rs1801689': ['A'], 'rs4148005': ['T'], 'rs35489971': ['A'], 'rs1135889': ['A'], 'rs3813127': ['A'], 'rs833509': ['T'], 'rs2000813': ['T'], 'rs34633411': ['T'], 'rs17616661': ['A'], 'rs3745348': ['T'], 'rs73015714': ['C'], 'rs12980942': ['A'], 'rs2288874': ['T'], 'rs8103278': ['A'], 'rs425105': ['T'], 'rs13734': ['A'], 'rs6088590': ['T'], 'rs9521678': ['T'], 'rs9583531': ['T'], 'rs1317507': ['A'], 'rs7145159': ['T'], 'rs2895811': ['T'], 'rs12440045': ['A'], 'rs6494488': ['A'], 'rs56062135': ['T'], 'rs2507': ['A'], 'rs6495335': ['T'], 'rs2880765': ['A'], 'rs8042271': ['A'], 'rs17514846': ['A'], 'rs17581137': ['A'], 'rs9972711': ['A'], 'rs1800775': ['A'], 'rs1050362': ['A'], 'rs4888378': ['A'], 'rs7199941': ['A'], 'rs12936587': ['A'], 'rs13723': ['A'], 'rs2074158': ['T'], 'rs17608766': ['T'], 'rs867186': ['A'], 'rs6129767': ['T'], 'rs3827066': ['T'], 'rs56313611': ['T'], 'rs2832227': ['A'], 'rs2836633': ['A'], 'rs2838344': ['A'], 'rs8141797': ['A'], 'rs5760293': ['T'], 'rs6006426': ['A'], 'rs12801636': ['A'], 'rs590121': ['T'], 'rs7947761': ['A'], 'rs12788925': ['A'], 'rs974819': ['T'], 'rs3758911': ['T'], 'rs73562014': ['A'], 'rs7933887': ['A'], 'rs3782774': ['A'], 'rs11610422': ['A'], 'rs12826942': ['A'], 'rs11172113': ['T'], 'rs2681492': ['T'], 'rs7306455': ['A'], 'rs3184504': ['T'], 'rs2244608': ['A'], 'rs11057401': ['A'], 'rs9319428': ['A'], 'rs9591012': ['A'], 'rs12866570': ['T'], 'rs12149545': ['A'], 'rs55730499': ['T'], 'rs472109': ['C'], 'rs2571445': ['A'], 'rs17091891': ['T'], 'rs2519093': ['T'], 'rs55791371': ['A'], 'rs7137828': ['T'], 'rs1334894': ['T'], 'rs6700559': ['T'], 'rs72743461': ['A'], 'rs6743030': ['T'], 'rs4845625': ['T'], 'rs507666': ['A'], 'rs1888657': ['T'], 'rs2487928': ['A'], 'rs1555321': ['A'], 'rs1254531': ['T'], 'rs1657346': ['C'], 'rs2879627': ['A'], 'rs4403732': ['C'], 'rs12264252': ['A'], 'rs2246942': ['A'], 'rs3740390': ['T'], 'rs12765878': ['T'], 'rs7901695': ['T'], 'rs2257129': ['T'], 'rs2268344': ['T'], 'rs77628708': ['T'], 'rs7941600': ['A'], 'rs10840293': ['A'], 'rs11042937': ['T'], 'rs11022738': ['T'], 'rs11024074': ['T'], 'rs16917237': ['T'], 'rs2727020': ['C'], 'rs4644046': ['A'], 'rs9367716': ['T'], 'rs4613862': ['A'], 'rs9486719': ['A'], 'rs9493740': ['T'], 'rs2327429': ['T'], 'rs2811686': ['T'], 'rs2153219': ['A'], 'rs12663498': ['T'], 'rs688359': ['A'], 'rs147555597': ['A'], 'rs41272114': ['T'], 'rs41269133': ['T'], 'rs10267593': ['A'], 'rs11509880': ['A'], 'rs4719608': ['A'], 'rs35146811': ['A'], 'rs68170813': ['T'], 'rs10249651': ['T'], 'rs7783857': ['C'], 'rs10237377': ['T'], 'rs6997340': ['T'], 'rs6997330': ['C'], 'rs264': ['A'], 'rs11204085': ['T'], 'rs6984210': ['C'], 'rs113756303': ['T'], 'rs12675257': ['T'], 'rs2342781': ['C'], 'rs2954029': ['A'], 'rs475957': ['T'], 'rs896655': ['A'], 'rs3217978': ['A'], 'rs1333049': ['C'], 'rs1322052': ['T'], 'rs4743150': ['T'], 'rs4149309': ['A'], 'rs1800978': ['C'], 'rs944172': ['T'], 'rs111245230': ['T'], 'rs10818576': ['T'], 'rs1476098': ['A'], 'rs9892152': ['T'], 'rs34991912': ['T'], 'rs4977574': ['A'], 'rs651821': ['T'], 'rs170041': ['T'], 'rs185244': ['T'], 'rs6544713': ['T'], 'rs6728861': ['A'], 'rs11613352': ['T'], 'rs1892094': ['T'], 'rs11204892': ['A'], 'rs62076439': ['T'], 'rs1807214': ['A'], 'rs2814944': ['A'], 'rs35158675': ['A'], 'rs602633': ['T'], 'rs17081933': ['A'], 'rs2843152': ['C'], 'rs2493298': ['A'], 'rs17037390': ['A'], 'rs35465346': ['A'], 'rs4072980': ['A'], 'rs4634932': ['T'], 'rs17416285': ['C'], 'rs950037': ['T'], 'rs11806316': ['A'], 'rs11204666': ['T'], 'rs11810571': ['C'], 'rs2820315': ['T'], 'rs11571537': ['T'], 'rs17465637': ['A'], 'rs2281719': ['T'], 'rs699': ['A'], 'rs668948': ['A'], 'rs1550115': ['T'], 'rs2052923': ['T'], 'rs10495907': ['A'], 'rs898123': ['C'], 'rs1561198': ['T'], 'rs10186133': ['T'], 'rs2923': ['C'], 'rs78490412': ['T'], 'rs17678683': ['T'], 'rs2252641': ['T'], 'rs33998987': ['T'], 'rs12619842': ['C'], 'rs840616': ['T'], 'rs115654617': ['A'], 'rs1250229': ['T'], 'rs2943634': ['A'], 'rs4566357': ['A'], 'rs1801251': ['A'], 'rs1405130': ['T'], 'rs13079221': ['C'], 'rs11718455': ['T'], 'rs7617773': ['T'], 'rs7623687': ['A'], 'rs4411878': ['T'], 'rs9840892': ['A'], 'rs17843797': ['T'], 'rs10512861': ['T'], 'rs73222236': ['A'], 'rs12493885': ['C'], 'rs12897': ['A'], 'rs16844401': ['A'], 'rs2616407': ['T'], 'rs57265257': ['A'], 'rs2452600': ['T'], 'rs17035270': ['T'], 'rs11723436': ['A'], 'rs35879803': ['A'], 'rs4593108': ['C'], 'rs6842241': ['A'], 'rs564398': ['G'], 'rs980831': ['T'], 'rs2072633': ['A'], 'rs138730015': ['G'], 'rs139401390': ['G'], 'rs35610040': ['G'], 'rs10778546': ['A'], 'rs72711827': ['A'], 'rs2235642': ['T'], 'rs56307353': ['T'], 'rs12713421': ['A'], 'rs5993586': ['T'], 'rs6426551': ['A'], 'rs60724295': ['A'], 'rs4836390': ['T'], 'rs3741380': ['A'], 'rs587648': ['T'], 'rs4934855': ['A'], 'rs13102675': ['T'], 'rs62139085': ['A'], 'rs11809443': ['T'], 'rs294883': ['T'], 'rs112001543': ['T'], 'rs6905628': ['C'], 'rs13035055': ['T'], 'rs67414899': ['C'], 'rs360798': ['A'], 'rs10892564': ['A'], 'rs28607113': ['T'], 'rs2671540': ['T'], 'rs144961578': ['A'], 'rs72823390': ['T'], 'rs73059933': ['A'], 'rs113716316': ['A'], 'rs603424': ['A'], 'rs2073533': ['T'], 'rs6736093': ['A'], 'rs7842194': ['A'], 'rs73104091': ['T'], 'rs73143584': ['A'], 'rs72945132': ['C'], 'rs79576311': ['A'], 'rs4906332': ['A'], 'rs4919044': ['T'], 'rs1223583': ['A'], 'rs9547692': ['A'], 'rs36069016': ['T'], 'rs4896604': ['A'], 'rs337366': ['A'], 'rs4394694': ['A'], 'rs12144309': ['T'], 'rs13092876': ['A'], 'rs117204111': ['A'], 'rs1185460': ['A'], 'rs61403071': ['T'], 'rs28522673': ['C'], 'rs840611': ['A'], 'rs4646248': ['T'], 'rs73193808': ['A'], 'rs8079951': ['A'], 'rs6557122': ['T'], 'rs2337157': ['A'], 'rs9964304': ['A'], 'rs8069437': ['T'], 'rs1912483': ['A'], 'rs236710': ['T'], 'rs56228609': ['T'], 'rs4918072': ['A'], 'rs10909862': ['A'], 'rs112635299': ['T'], 'rs11838267': ['T'], 'rs10131894': ['C'], 'rs41311933': ['T'], 'rs10806235': ['T'], 'rs566818': ['A'], 'rs659418': ['T'], 'rs34891485': ['T'], 'rs9912587': ['A'], 'rs12136712': ['A'], 'rs7220401': ['T'], 'rs59950280': ['A'], 'rs17398575': ['A'], 'rs7809950': ['T'], 'rs6001960': ['A'], 'rs34156428': ['A'], 'rs57677839': ['A'], 'rs3936510': ['T'], 'rs62390615': ['A'], 'rs6541297': ['A'], 'rs147802096': ['A'], 'rs116161686': ['A'], 'rs76954792': ['T'], 'rs6460942': ['T'], 'rs4496284': ['A'], 'rs28416651': ['A'], 'rs10951983': ['A'], 'rs1008898': ['T'], 'rs1692580': ['T'], 'rs36096196': ['T'], 'rs4266144': ['C'], 'rs2679053': ['A'], 'rs582384': ['A'], 'rs1434538': ['T'], 'rs11760633': ['T'], 'rs1623003': ['T'], 'rs13088645': ['A'], 'rs216158': ['C'], 'rs35099186': ['T'], 'rs2454899': ['A'], 'rs4800401': ['T'], 'rs12154802': ['A'], 'rs67807996': ['A'], 'rs35006': ['C'], 'rs10961206': ['A'], 'rs10121140': ['A'], 'rs10055631': ['A'], 'rs256277': ['T'], 'rs60787346': ['A'], 'rs111684993': ['A'], 'rs11690462': ['A'], 'rs1291621': ['A'], 'rs13010737': ['A'], 'rs877549': ['A'], 'rs4345206': ['T'], 'rs4753788': ['A'], 'rs2546343': ['T'], 'rs12315434': ['A'], 'rs2107732': ['A'], 'rs56079296': ['A'], 'rs10093110': ['A'], 'rs1321309': ['A'], 'rs11677932': ['A'], 'rs60154123': ['T'], 'rs885150': ['T'], 'rs4754698': ['C'], 'rs11107903': ['A'], 'rs112941079': ['A'], 'rs71566846': ['T'], 'rs7251815': ['T'], 'rs7998440': ['A'], 'rs2074164': ['C'], 'rs11080107': ['T'], 'rs1870634': ['T'], 'rs12214416': ['A'], 'rs140570886': ['T'], 'rs73596816': ['A'], 'rs145099029': ['A'], 'rs145542470': ['A'], 'rs2891168': ['A'], 'rs7797644': ['T'], 'rs4752700': ['A'], 'rs975722': ['A'], 'rs260020': ['T'], 'rs667920': ['T'], 'rs3936511': ['A'], 'rs6102343': ['A'], 'rs7633770': ['A'], 'rs2145598': ['A'], 'rs7116641': ['T'], 'rs3775058': ['A'], 'rs61848342': ['T'], 'rs17080091': ['T'], 'rs8046696': ['T'], 'rs515135': ['T'], 'rs606452': ['A'], 'rs6982502': ['T'], 'rs7173743': ['T'], 'rs6841581': ['A'], 'rs644045': ['A'], 'rs6909752': ['A'], 'rs789294': ['C'], 'rs2189839': ['A'], 'rs663640': ['T'], 'rs7926712': ['A'], 'rs12740679': ['G']}
	
	mapping_heart = {'rs10455872': ['G'], 'rs186696265': ['T'], 'rs7412': ['T'], 'rs328': ['G'], 'rs6511720': ['T'], 'rs7528419': ['G'], 'rs11057830': ['A'], 'rs12740374': ['T'], 'rs147233090': ['T'], 'rs62471956': ['G'], 'rs188845491': ['C'], 'rs140607780': ['G'], 'rs117038461': ['C'], 'rs61361928': ['T'], 'rs11556924': ['T'], 'rs11591147': ['T'], 'rs17114046': ['A'], 'rs4766578': ['A'], 'rs6060235': ['A'], 'rs6905288': ['A'], 'rs6740731': ['A'], 'rs15285': ['T'], 'rs964184': ['C'], 'rs16986953': ['A'], 'rs4803455': ['A'], 'rs11099493': ['A'], 'rs8053891': ['A'], 'rs9469890': ['T'], 'rs17228058': ['A'], 'rs1169288': ['A'], 'rs4299376': ['T'], 'rs495828': ['T'], 'rs9515203': ['T'], 'rs2107595': ['A'], 'rs1412444': ['T'], 'rs459193': ['A'], 'rs742115': ['T'], 'rs9349379': ['A'], 'rs2814993': ['A'], 'rs10947789': ['T'], 'rs16948048': ['A'], 'rs8080784': ['T'], 'rs2000813': ['T'], 'rs34633411': ['T'], 'rs17616661': ['A'], 'rs425105': ['T'], 'rs9583531': ['T'], 'rs2895811': ['T'], 'rs2507': ['A'], 'rs1800775': ['A'], 'rs12936587': ['A'], 'rs2074158': ['T'], 'rs867186': ['A'], 'rs8141797': ['A'], 'rs12801636': ['A'], 'rs974819': ['T'], 'rs11172113': ['T'], 'rs2681492': ['T'], 'rs7306455': ['A'], 'rs3184504': ['T'], 'rs2244608': ['A'], 'rs9319428': ['A'], 'rs12149545': ['A'], 'rs55791371': ['A'], 'rs4845625': ['T'], 'rs507666': ['A'], 'rs1555321': ['A'], 'rs12264252': ['A'], 'rs7901695': ['T'], 'rs11042937': ['T'], 'rs2327429': ['T'], 'rs41272114': ['T'], 'rs10237377': ['T'], 'rs264': ['A'], 'rs2954029': ['A'], 'rs475957': ['T'], 'rs1333049': ['C'], 'rs4743150': ['T'], 'rs111245230': ['T'], 'rs4977574': ['A'], 'rs651821': ['T'], 'rs6544713': ['T'], 'rs11613352': ['T'], 'rs2814944': ['A'], 'rs602633': ['T'], 'rs4072980': ['A'], 'rs11571537': ['T'], 'rs17465637': ['A'], 'rs699': ['A'], 'rs668948': ['A'], 'rs1561198': ['T'], 'rs2252641': ['T'], 'rs1250229': ['T'], 'rs11718455': ['T'], 'rs12493885': ['C'], 'rs2452600': ['T'], 'rs17035270': ['T'], 'rs35879803': ['A'], 'rs2072633': ['A'], 'rs35610040': ['G'], 'rs72711827': ['A'], 'rs6426551': ['A'], 'rs603424': ['A'], 'rs117204111': ['A'], 'rs6557122': ['T'], 'rs112635299': ['T'], 'rs9912587': ['A'], 'rs7220401': ['T'], 'rs17398575': ['A'], 'rs3936510': ['T'], 'rs1008898': ['T'], 'rs2679053': ['A'], 'rs877549': ['A'], 'rs12214416': ['A'], 'rs140570886': ['T'], 'rs73596816': ['A'], 'rs515135': ['T'], 'rs606452': ['A'], 'rs6841581': ['A'], 'rs644045': ['A']}

	heart_data = []
	for k,v in mapping_heart.items():
		if k in mapping_user:
			is_found = False
			for a in v:
				if a in mapping_user[k]:
					heart_data.append(1)
					is_found = True
					break
			if not is_found:
				heart_data.append(0)
		# else:
		# 	heart_data.append(np.random.choice([0,1],p=[0.7,0.3]))

	heart_data = [heart_data]
	heart_test = pd.DataFrame(heart_data)

	# Load the model from the file
	if age>=60:
		heart_model = joblib.load('23andme/heart-model-old.pkl') 
	elif age>=40:
		heart_model = joblib.load('23andme/heart-model-mid.pkl') 
	elif age>25:
		heart_model = joblib.load('23andme/heart-model-young.pkl') 
	else:
		heart_pred = [0]

	# Use the loaded model to make predictions
	if age>25:
		heart_pred = heart_model.predict(heart_test)



	"""
	Type 1 diabetes
	"""
	print("Predicting your risk factor for Type 1 diabetes...")
	#mapping of rsid to risk allele
	# mapping_diabetes = {'rs10751776': ['C'], 'rs574384': ['A'], 'rs12742756': ['G'], 'rs855330': ['C'], 'rs1493696': ['A'], 'rs570794153': ['G'], 'rs12128789': ['C'], 'rs1881146': ['T'], 'rs12464462': ['G'], 'rs13018977': ['A'], 'rs12644686': ['G'], 'rs114378220': ['T'], 'rs766751473': ['T'], 'rs1050979': ['G'], 'rs7805218': ['A'], 'rs7795896': ['T'], 'rs1947178': ['G'], 'rs13259300': ['C'], 'rs3802214': ['C'], 'rs541856133': ['T'], 'rs537544': ['T'], 'rs78325861': ['G'], 'rs140215710': ['A'], 'rs7936434': ['C'], 'rs607703': ['T'], 'rs7301381': ['C'], 'rs238265': ['G'], 'rs4238595': ['C'], 'rs8046043': ['C'], 'rs61759532': ['T'], 'rs11651753': ['T'], 'rs57209021': ['T'], 'rs74203920': ['T'], 'rs111821448': ['C'], 'rs139881548': ['C'], 'rs34740712': ['C'], 'rs4513644': ['T'], 'rs78824139': ['C'], 'rs6461299': ['C'], 'rs10255565': ['C'], 'rs35766765': ['G'], 'rs74629033': ['G'], 'rs10961433': ['G'], 'rs4837404': ['G'], 'rs1110458': ['C'], 'rs2941522': ['C'], 'rs10258381': ['G'], 'rs116020851': ['C'], 'rs9501130': ['G'], 'rs17407280': ['C'], 'rs10919543': ['G'], 'rs7524087': ['G'], 'rs77155259': ['G'], 'rs11725853': ['A'], 'rs2410601': ['G'], 'rs114631266': ['C'], 'rs2471863': ['C'], 'rs34941730': ['G'], 'rs45626136': ['C'], 'rs1265057': ['C'], 'rs116763857': ['G'], 'rs9264758': ['G'], 'rs3093664': ['G'], 'rs3134938': ['C'], 'rs926592': ['C'], 'rs3135365': ['C'], 'rs9268576': ['C'], 'rs7760731': ['C'], 'rs9275358': ['G'], 'rs35122968': ['C'], 'rs3997848': ['G'], 'rs241427': ['G'], 'rs4148870': ['C'], 'rs3128930': ['C'], 'rs2085277': ['T'], 'rs559047': ['A']}
	
	mapping_diabetes = {'rs1493696': ['A'], 'rs1050979': ['G'], 'rs74203920': ['T'], 'rs78824139': ['C'], 'rs116020851': ['C'], 'rs45626136': ['C'], 'rs116763857': ['G'], 'rs3093664': ['G'], 'rs3135365': ['C'], 'rs35122968': ['C'], 'rs241427': ['G'], 'rs4148870': ['C'], 'rs3128930': ['C']}

	diabetes_data = []
	for k,v in mapping_diabetes.items():
		if k in mapping_user:
			is_found = False
			for a in v:
				if a in mapping_user[k]:
					diabetes_data.append(1)
					is_found = True
					break
			if not is_found:
				diabetes_data.append(0)
		# else:
		# 	diabetes_data.append(np.random.choice([0,1],p=[0.7,0.3]))

	diabetes_data = [diabetes_data]
	diabetes_test = pd.DataFrame(diabetes_data)

	# Load the model from the file
	diabetes_model = joblib.load('23andme/diabetes-model.pkl') 

	# Use the loaded model to make predictions
	diabetes_pred = diabetes_model.predict(diabetes_test)




	"""
	Type 1 diabetes
	"""
	print("Predicting your risk factor for Hypertension...")
	#mapping of rsid to risk allele
	# mapping_hyper = {'chr1:218216863': ['A'], 'chr3:190369649': ['G'], 'chr22:19342329': ['C'], 'chr13:33831026': ['A'], 'chr6:45490690': ['T'], 'chr14:46568609': ['A'], 'chr4:140544936': ['A'], 'chr14:68773739': ['T'], 'chr11:21259199': ['T'], 'chr5:156144905': ['G'], 'chr14:97468972': ['C'], 'chr2:40645825': ['A'], 'chr6:158195695': ['G'], 'chr7:137230391': ['C'], 'chr1:205796021': ['C'], 'chr13:92244167': ['T'], 'chr5:76411774': ['T'], 'chr7:55729814': ['C'], 'chr2:60002943': ['G'], 'chr15:62437471': ['C'], 'chr11:127223995': ['C'], 'chr20:61032694': ['T'], 'chr2:148156515': ['T'], 'chr21:15364317': ['A'], 'chr3:37276320': ['T'], 'chr9:18139412': ['G'], 'chr1:115464269': ['C'], 'chr15:38626475': ['C'], 'chr5:38751223': ['C'], 'chr19:10408439': ['C'], 'chr2:34319717': ['A'], 'chr3:65620508': ['G'], 'chr16:65929016': ['G'], 'chr14:95912388': ['A'], 'chr9:106700069': ['T'], 'chr5:50624217': ['G'], 'chr14:48940347': ['T'], 'chr5:58418501': ['A'], 'chr13:106475443': ['T'], 'chr11:2913938': ['T'], 'chr4:180442771': ['C'], 'chr21:45737605': ['T'], 'chr8:81977545': ['C'], 'chr2:158485292': ['A'], 'chr10:76167912': ['A'], 'chr19:55129569': ['A'], 'chr5:27411608': ['T'], 'chr12:70421583': ['C'], 'chr20:47032395': ['A'], 'chr6:26045367': ['T'], 'chr16:56697867': ['G'], 'chr18:66520811': ['A'], 'chr5:1688900': ['A'], 'chr20:10244172': ['C'], 'chr17:42821246': ['C'], 'chr4:144288418': ['A'], 'chr14:104359310': ['T'], 'chr1:28452553': ['T'], 'chr18:29665179': ['G'], 'chr1:4550104': ['A'], 'chr15:42938962': ['A'], 'chr3:70984708': ['C'], 'chr16:4200277': ['T'], 'chr21:30014690': ['A'], 'chr20:52774427': ['G'], 'chr3:39754820': ['C'], 'chr7:133636770': ['A'], 'chr7:134039988': ['A'], 'chr17:70810958': ['G'], 'chr3:68603582': ['G'], 'chr10:13468298': ['G'], 'chr16:7504546': ['G'], 'chr22:41218683': ['C'], 'chr6:88202550': ['A'], 'chr2:68350730': ['T'], 'chr10:33886562': ['G'], 'chr8:142574962': ['T'], 'chr13:76825276': ['A'], 'chr1:182097713': ['C'], 'chr3:123014904': ['T'], 'chr16:77814065': ['A'], 'chr15:41901475': ['C'], 'chr3:37843727': ['A'], 'chr22:19321745': ['A'], 'chr15:24599180': ['A'], 'chr8:51443231': ['C'], 'chr11:2852309': ['T'], 'chr16:5571510': ['T'], 'chr14:47049146': ['G'], 'chr1:23715978': ['G'], 'chr10:97987596': ['C'], 'chr8:92693591': ['T'], 'chr5:76449714': ['G'], 'chr2:2870592': ['G'], 'chr20:11017205': ['C'], 'chr3:47580813': ['T'], 'chr8:77343407': ['G'], 'chr8:89122108': ['C'], 'chr7:10129002': ['T'], 'chr17:47989987': ['G'], 'chr10:76827323': ['A'], 'chr5:10515903': ['G'], 'chr14:89369962': ['A'], 'chr3:69281337': ['G'], 'chr9:31295759': ['A'], 'chr19:42342073': ['A'], 'chr7:18282368': ['A'], 'chr6:162192205': ['A'], 'chr12:119779963': ['T'], 'chr8:134743852': ['T'], 'chr22:47691442': ['T'], 'chr16:57510363': ['A'], 'chr11:121771661': ['A'], 'chr4:187490357': ['G'], 'chr7:144890144': ['C'], 'chr14:36281438': ['C'], 'chr5:10489128': ['T'], 'chr14:62849226': ['G'], 'chr8:71365589': ['T'], 'chr15:63923093': ['C'], 'chr12:48800679': ['A'], 'chr9:115570712': ['T'], 'rs4905794': ['G'], 'rs16984571': ['G'], 'rs2119704': ['A'], 'rs10817396': ['G'], 'rs12509878': ['C'], 'rs1230361': ['A'], 'rs822127': ['A'], 'rs9370524': ['A'], 'rs10951933': ['T'], 'rs2198596': ['C'], 'rs11784910': ['A'], 'rs17755650': ['T'], 'rs177848': ['A'], 'rs11657217': ['C'], 'rs7565329': ['T'], 'rs12642634': ['A'], 'rs11750990': ['A'], 'rs2876449': ['T'], 'rs2925663': ['T'], 'rs13253998': ['T'], 'rs7960884': ['A'], 'rs16962897': ['A'], 'rs4150161': ['T'], 'rs11775334': ['A'], 'rs2681472': ['A'], 'rs16982520': ['A'], 'rs11014166': ['A'], 'rs9943291': ['G'], 'rs61824877': ['A'], 'rs28404156': ['A'], 'rs16964543': ['T'], 'rs4077408': ['A'], 'rs3768939': ['A'], 'rs7751419': ['T'], 'rs79105258': ['A'], 'rs17004869': ['A'], 'rs10857147': ['A'], 'rs3774427': ['C'], 'rs16998073': ['A'], 'rs880315': ['T'], 'rs1731243': ['T'], 'rs112913898': ['A'], 'rs1731249': ['A'], 'rs1275988': ['T'], 'rs1973765': ['T'], 'rs1902859': ['T'], 'rs12219304': ['C'], 'rs17046380': ['T'], 'rs6969780': ['C'], 'rs891511': ['A'], 'rs11537751': ['T'], 'rs7302981': ['A'], 'rs167479': ['T'], 'rs28495639': ['A'], 'rs569550': ['T'], 'rs8039305': ['T'], 'rs35443': ['C'], 'rs35434': ['A'], 'rs4462906': ['T'], 'rs9907379': ['T'], 'rs1859168': ['A'], 'rs12715461': ['A'], 'rs62524579': ['A'], 'rs17030613': ['A'], 'rs1333047': ['A'], 'rs12679242': ['T'], 'rs2305013': ['A'], 'rs604723': ['T'], 'rs6461992': ['A'], 'rs62525059': ['A'], 'rs12630213': ['T'], 'rs16896398': ['A'], 'rs4722675': ['A'], 'rs16849225': ['T'], 'rs13139571': ['A'], 'rs180912': ['T'], 'rs661348': ['T'], 'rs4910498': ['A'], 'rs17249754': ['A'], 'rs10948071': ['T'], 'rs10069554': ['T'], 'rs16849211': ['T'], 'rs6825911': ['T'], 'rs1327235': ['A'], 'rs12579720': ['C'], 'rs284844': ['A'], 'rs6021247': ['A'], 'rs1887320': ['A'], 'rs9375459': ['T'], 'rs1105956': ['A'], 'rs217727': ['A'], 'rs751984': ['T'], 'rs31864': ['A'], 'rs11230728': ['A'], 'rs66978877': ['T'], 'rs6536088': ['A'], 'rs13002573': ['A'], 'rs2681492': ['T'], 'rs12579302': ['A'], 'rs11105364': ['T'], 'rs6590816': ['A'], 'rs1401982': ['A'], 'rs8098380': ['A'], 'rs8101673': ['T'], 'rs2240736': ['T'], 'rs820430': ['A'], 'rs1563788': ['T'], 'rs13112725': ['C'], 'rs6712094': ['A'], 'rs6506537': ['T'], 'rs2270860': ['T'], 'rs7297206': ['T'], 'rs10184428': ['A'], 'rs6590812': ['A'], 'rs633185': ['C', 'G'], 'rs2649044': ['T'], 'rs1004467': ['A'], 'rs2125067': ['C'], 'rs6590811': ['T'], 'rs2067087': ['C'], 'rs5006548': ['T'], 'rs6418': ['A'], 'rs58244401': ['A'], 'rs10033366': ['T'], 'rs2643826': ['T'], 'rs4409766': ['T'], 'rs35444': ['A'], 'rs4684242': ['C'], 'rs4980389': ['A'], 'rs12129649': ['T'], 'rs11191548': ['T'], 'rs13149993': ['A'], 'rs11191580': ['T'], 'rs17514846': ['A'], 'rs11191593': ['T'], 'rs72806698': ['T'], 'rs3790604': ['A'], 'rs1458038': ['T'], 'rs10776752': ['T'], 'rs35021474': ['C'], 'rs11099098': ['T'], 'rs9814480': ['T'], 'rs139293840': ['A'], 'rs35529250': ['T'], 'rs9349379': ['A'], 'rs4728142': ['A'], 'rs4387287': ['A'], 'rs11229457': ['T'], 'rs1126464': ['C'], 'rs7406910': ['T'], 'rs8068318': ['T'], 'rs13333226': ['A'], 'rs2972146': ['T'], 'rs1799945': ['G'], 'rs1173771': ['G'], 'rs932764': ['G'], 'rs4373814': ['G'], 'rs11953630': ['T'], 'rs2932538': ['G'], 'rs805303': ['G'], 'rs13107325': ['T'], 'rs2521501': ['T'], 'rs6015450': ['G'], 'rs897876': ['T']}
	
	mapping_hyper = {'rs4905794': ['G'], 'rs2119704': ['A'], 'rs17755650': ['T'], 'rs7565329': ['T'], 'rs11775334': ['A'], 'rs2681472': ['A'], 'rs11014166': ['A'], 'rs9943291': ['G'], 'rs16998073': ['A'], 'rs880315': ['T'], 'rs17046380': ['T'], 'rs891511': ['A'], 'rs11537751': ['T'], 'rs7302981': ['A'], 'rs28495639': ['A'], 'rs62524579': ['A'], 'rs17030613': ['A'], 'rs16849225': ['T'], 'rs13139571': ['A'], 'rs17249754': ['A'], 'rs6825911': ['T'], 'rs1327235': ['A'], 'rs6021247': ['A'], 'rs1887320': ['A'], 'rs13002573': ['A'], 'rs2681492': ['T'], 'rs820430': ['A'], 'rs633185': ['C', 'G'], 'rs4409766': ['T'], 'rs35444': ['A'], 'rs11191548': ['T'], 'rs11191580': ['T'], 'rs11191593': ['T'], 'rs1458038': ['T'], 'rs11099098': ['T'], 'rs9349379': ['A'], 'rs4728142': ['A'], 'rs4387287': ['A'], 'rs7406910': ['T'], 'rs13333226': ['A'], 'rs2972146': ['T'], 'rs1799945': ['G'], 'rs1173771': ['G'], 'rs932764': ['G'], 'rs2932538': ['G'], 'rs805303': ['G'], 'rs2521501': ['T']}


	hyper_data = []
	for k,v in mapping_hyper.items():
		if k in mapping_user:
			is_found = False
			for a in v:
				if a in mapping_user[k]:
					hyper_data.append(1)
					is_found = True
					break
			if not is_found:
				hyper_data.append(0)
		# else:
		# 	hyper_data.append(np.random.choice([0,1],p=[0.7,0.3]))

	hyper_data = [hyper_data]
	hyper_test = pd.DataFrame(hyper_data)

	# Load the model from the file
	if age>=60:
		hyper_model = joblib.load('23andme/hypertension-model-old.pkl')
	elif age>=40:
		hyper_model = joblib.load('23andme/hypertension-model-mid.pkl')
	elif age>25:
		hyper_model = joblib.load('23andme/hypertension-model-young.pkl')
	else:
		hyper_pred = [0]
	

	# Use the loaded model to make predictions
	if age>25:
		hyper_pred = hyper_model.predict(hyper_test)




	"""
	Rheumatoid arthritis
	"""
	print("Predicting your risk factor for Rheumatoid arthritis...")
	#mapping of rsid to risk allele
	# mapping_arth = {'rs2476601': ['A'], 'rs2451258': ['T'], 'rs147622113': ['T'], 'rs59716545': ['T'], 'rs947474': ['A'], 'rs3824660': ['T'], 'rs8026898': ['A'], 'rs2301888': ['A'], 'rs8133843': ['A'], 
	# 				'rs13330176': ['A'], 'rs1893592': ['A'], 'rs2105325': ['A'], 'rs4239702': ['T'], 'rs2233424': ['T'], 'rs2234067': ['A'], 'rs624988': ['T'], 'rs73081554': ['T'], 'rs8032939': ['T'], 'rs73194058': ['A'], 
	# 				'rs773125': ['A'], 'rs1633360': ['T'], 'rs9826828': ['A'], 'rs706778': ['T'], 'rs1980422': ['T'], 'rs9603616': ['T'], 'rs187786174': ['A'], 'rs4452313': ['A'], 'rs909685': ['A'], 'rs2561477': ['A'], 'rs1858037': ['A'], 
	# 				'rs7731626': ['A'], 'rs3087243': ['A'], 'rs17264332': ['A'], 'rs7752903': ['T'], 'rs28411352': ['T'], 'rs11933540': ['T'], 'rs34536443': ['G'], 'rs10790268': ['A'], 'rs1571878': ['T'], 'rs10985070': ['A'], 'rs34695944': ['T'], 'rs11574914': ['A'], 'rs71508903': ['T'], 
	# 				'rs3806624': ['A'], 'rs9653442': ['T'], 'rs3778753': ['A'], 'rs11889341': ['T'], 'rs8083786': ['A'], 'rs998731': ['T'], 'rs10175798': ['A'], 'rs9268839': ['A'], 'rs726288': ['T'], 'rs3783782': ['A'], 'rs6479800': ['G'], 'rs73013527': ['T'], 
	# 				'rs761426': ['A'], 'rs2469434': ['T'], 'rs2736337': ['T'], 'rs75409195': ['G'], 'rs2582532': ['T'], 'rs227163': ['T'], 'rs9373594': ['T'], 'rs10028001': ['A'], 'rs74984480': ['T'], 'rs657075': ['A'], 'rs678347': ['A'], 'rs9378815': ['G'], 'rs10774624': ['A'], 
	# 				'rs1950897': ['T'], 'rs147868091': ['T'], 'rs6715284': ['G'], 'rs12413578': ['T'], 'rs4272': ['A'], 'rs12140275': ['A'], 'rs138193887': ['A'], 'rs4780401': ['T'], 'rs1516971': ['T'], 'rs11089637': ['T'], 'rs968567': ['T'], 'rs72717009': ['T'], 'rs67250450': ['T'], 
	# 				'rs13142500': ['T'], 'rs2664035': ['A'], 'rs45475795': ['A'], 'rs508970': ['A'], 'rs2228145': ['A'], 'rs331463': ['A'], 'rs793108': ['T'], 'rs7216796': ['A'], 'rs59902911': ['T'], 'rs116199914': ['G'], 'rs1695024': ['A'], 'rs111703287': ['T'], 'rs4336372': ['C'], 'rs12570744': ['T'], 
	# 				'rs7141276': ['A'], 'rs284515': ['G'], 'rs75908454': ['C'], 'rs284511': ['C'], 'rs1679568': ['A'], 'rs923880': ['C'], 'rs41005': ['T'], 'rs13015080': ['A'], 'rs1079467': ['C'], 'rs16973500': ['T'], 'rs1498103': ['A']}

	mapping_arth = {'rs2451258': ['T'], 'rs947474': ['A'], 'rs3824660': ['T'], 'rs8026898': ['A'], 'rs8133843': ['A'], 'rs13330176': ['A'], 'rs1893592': ['A'], 'rs4239702': ['T'], 'rs2233424': ['T'], 'rs624988': ['T'], 'rs73081554': ['T'], 'rs8032939': ['T'], 'rs773125': ['A'], 'rs9826828': ['A'], 'rs1980422': ['T'], 'rs4452313': ['A'], 'rs909685': ['A'], 'rs2561477': ['A'], 'rs1858037': ['A'], 'rs7731626': ['A'], 'rs3087243': ['A'], 'rs17264332': ['A'], 'rs28411352': ['T'], 'rs11933540': ['T'], 'rs34536443': ['G'], 'rs1571878': ['T'], 'rs10985070': ['A'], 'rs34695944': ['T'], 'rs11574914': ['A'], 'rs71508903': ['T'], 'rs3806624': ['A'], 'rs9653442': ['T'], 'rs11889341': ['T'], 'rs998731': ['T'], 'rs10175798': ['A'], 'rs9268839': ['A'], 'rs726288': ['T'], 'rs73013527': ['T'], 'rs2469434': ['T'], 'rs2736337': ['T'], 'rs2582532': ['T'], 'rs227163': ['T'], 'rs657075': ['A'], 'rs678347': ['A'], 'rs1950897': ['T'], 'rs6715284': ['G'], 'rs12413578': ['T'], 'rs4272': ['A'], 'rs4780401': ['T'], 'rs1516971': ['T'], 'rs11089637': ['T'], 'rs968567': ['T'], 'rs67250450': ['T'], 'rs2664035': ['A'], 'rs45475795': ['A'], 'rs508970': ['A'], 'rs331463': ['A'], 'rs116199914': ['G'], 'rs16973500': ['T']}


	arth_data = []
	for k,v in mapping_arth.items():
		if k in mapping_user:
			is_found = False
			for a in v:
				if a in mapping_user[k]:
					arth_data.append(1)
					is_found = True
					break
			if not is_found:
				arth_data.append(0)
		# else:
		# 	arth_data.append(np.random.choice([0,1],p=[0.7,0.3]))

	arth_data = [arth_data]
	arth_test = pd.DataFrame(arth_data)

	# Load the model from the file
	if age>=60:
		arth_model = joblib.load('23andme/arthritis-model-old.pkl') 
	elif age>=40:
		arth_model = joblib.load('23andme/arthritis-model-mid.pkl') 
	elif age>25:
		arth_model = joblib.load('23andme/arthritis-model-young.pkl') 
	else:
		arth_pred = [0]

	# Use the loaded model to make predictions
	if age>25:
		arth_pred = arth_model.predict(arth_test)




	# Results
	result_mapping = {0:"Low Risk", 1: "Medium Risk", 2: "High Risk"}

	print("Here are your results:")
	print("Alzheimer's disease: ", result_mapping[alzheimer_pred[0]])
	print("Coronary heart disease: ", result_mapping[heart_pred[0]])
	print("Type 1 diabetes: ", result_mapping[diabetes_pred[0]])
	print("Hypertension: ", result_mapping[hyper_pred[0]])
	print("Rheumatoid arthritis: ", result_mapping[arth_pred[0]])




